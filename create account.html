<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Create Hospital Account – Medipedia</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="create account.css">
  <script src="https://cdn.jsdelivr.net/npm/js-sha256@0.9.0/src/sha256.min.js"></script>
</head>
<body>
  <section class="card wide">
    <h1>Medipedia</h1>
    <p class="tag">Create Hospital Account</p>

    <form id="regForm">
      <!-- ===== HOSPITAL DETAILS ===== -->
      <h3 style="margin-bottom:12px;color:var(--blue)">Hospital Details</h3>
      <input type="text"    name="hospital_name"  placeholder="Hospital Name *" required>
      <input type="text"    name="address"        placeholder="Hospital Address *" required>
      <input type="text"    name="country"        placeholder="Country *" required>
      <input type="text"    name="licence_no"     placeholder="Hospital Licence Number *" required>
      <input type="email"   name="contact_email"  placeholder="Contact Email *" required>
      <input type="tel"     name="phone"          placeholder="Phone">

      <!-- ===== ADMIN USER ===== -->
      <h3 style="margin:20px 0 12px;color:var(--blue)">Admin User</h3>
      <input type="text"    name="name"       placeholder="Full Name *" required>
      <input type="email"   name="email"      placeholder="Personal Email *" required>
      <input type="password"name="pwd"        placeholder="Password *" required minlength="6">
      <input type="password"name="pwd2"       placeholder="Confirm Password *" required minlength="6">

      <button type="submit">Create Account</button>
    </form>

    <p class="foot">Already registered? <a href="login.html">Sign In</a></p>
  </section>

  <script>
    document.getElementById('regForm').addEventListener('submit', e => {
      e.preventDefault();
      const data = Object.fromEntries(new FormData(e.target));
      if(data.pwd !== data.pwd2){alert("Passwords do not match");return;}

      const users = JSON.parse(localStorage.getItem('mpUsers') || '[]');
      if(users.find(u=>u.email===data.email)){alert("Email already registered");return;}

      users.push({
        hospital: {
          name:       data.hospital_name,
          address:    data.address,
          country:    data.country,
          licence_no: data.licence_no,
          contact_email:data.contact_email,
          phone:      data.phone
        },
        personal: {
          name: data.name,
          email:data.email,
          passwordHash: sha256(data.pwd)   // one-way hash
        }
      });
      localStorage.setItem('mpUsers', JSON.stringify(users));
      alert("Account created! Redirecting …");
      location.href = 'login.html';
    });
  </script>
</body>
</html>